******************************************
　ダウンロード販売拡張プラグイン
　　　WCEX DLSeller for Welcart
******************************************


WCEX DLSeller はWelcart専用の拡張プラグインです。
DLSeller は、Welcart 本体の物販機能を拡張して、データファイルのダウンロード販売、
及び情報・サービスの販売を同時に行える様にするためのプラグインです。

全ての商品で、通常課金か継続課金かの選択ができ、継続課金の場合は毎月、半年毎、
1年毎の課金方法を指定できます。

ご利用方法の詳細は、オンラインドキュメントをご覧ください。
https://www.welcart.com/docs/DLSeller/index.html


=================
各販売方法の特徴
=================

【物販】
物販とは、配送が必要な商品のことです。
Welcart の基本機能で、DLSeller を利用してもその機能は変りません。


【データ・ダウンロード販売】
zip、jpg、mp3 など、様々なコンテンツファイルをダウンロード形式で提供・販売できます。
物販と同じ決済方法が利用でき、カード決済を選択した場合は、決済完了ページにて直に
ダウンロードが可能となります。また、再ダウンロード有効期間内は会員情報ページの
購入履歴から再ダウンロードが可能です。

データをダウンロード購入する場合はログインが必要となります。カートページ遷移中に
新規入会を行なった場合でも購入手続きを中断する事が無いのでカゴ落ちを軽減できます。

また、ファイルの不正ダウンロードに考慮していますので安心してお使いいただけます。


【サービス販売】
修理作業費や製品サポートなどのサービスを販売する事ができます。
他の販売方法同様、継続課金が利用できますので、様々なサービス販売が可能です。

サービスを購入する場合はログインが必要となります。カートページ遷移中に新規入会を
行なった場合でも購入手続きを中断する事が無いのでカゴ落ちを軽減できます。



=================
制限事項と注意
=================

【旧バージョンからのアップグレードについて】
旧バージョン（v1.x）からこのバージョンにアップグレードしt場合、商品データの更新処理が
必要です。管理パネルの商品情報編集ページに入り、全商品に対して「商品区分」及び
「課金タイプ」を選択して更新してください。


【データ商品のファイルについて】
データの商品登録は、1商品に対して1ファイルとなります。1商品に対してダウンロードする
ファイルをお客様に選択させるような販売方法はできません。


【カート投入について】
物販、データ、サービスを同時にカートに投入する事はできますが、通常課金の商品と
継続課金の商品を同時にカートに入れる事はできません。また、継続課金の場合は
カートに1商品しか投入できない仕様になっています。いずれの場合もカートに投入しよう
とした場合に「カートをクリアするかどうか」のメッセージが表示されます。


【クレジット決済について】
継続課金で利用できる決済方法は、「ルミーズ」、「PayPalエクスプレス」のみです。
継続課金に限らず、商材によっては決済代行業者との契約内容が異なる事が有りますので
どのような販売形態なのかを決済代行業者に説明して契約が可能かどうかを確認してください。


【継続課金の停止について】
継続課金は、契約期間を設定しても自動停止はしない仕様になっています。契約が終了した場合は
各決済サービスの管理画面より、停止処理を行なってください。


【クレジットカードの有効期限切れについて】
下記の「継続課金会員リスト」の項をご覧ください。


【テーマについて】
DLSeller には専用のwc_templates テンプレートが添付されています。適宜、ご利用の
テーマフォルダにコピーしてご使用ください。
また、Welcart Default テーマ内にあるwc_templates とは内容が異なりますので、
必ず、wc_templates を削除するか、DLSeller 専用のwc_templates に入れ替えてご使用ください。



==============
ご利用方法
==============

【インストール】
ご利用になるにはWelcartの最新版（ｖ1.3以降）をインストールした後、DLSeller を
インストールします。
管理パネルのプラグインの新規追加画面（プラグインのインストール）から
”アップロード”リンクをクリックして、ダウンロードしたWCEX DLSeller の
圧縮ファイル（[例]wcex_dlseller.2.0.zip）をそのままアップロードして有効化します。


【テンプレートの準備】
wcex_dlseller ディレクトリ内にあるwc_templates をディレクトリごとご利用中の
テーマのなかにコピーしてください。既にテーマの中にwc_templates が存在する場合は
一旦削除してからDLSeller のwc_templates を設置します。


【コンテンツ・ディレクトリの準備】
次に、ダウンロード販売するファイルを格納するディレクトリを用意します。
設置場所はどこでも構いません。例えばルートに”contents”[例]というディレクトリを
作成します。そしてその配下に予測しにくい名前のディレクトリを作成します。
例えば”afsdf001245sss”[例]といった感じです。このフォルダの中に圧縮ファイルを
格納します。

robots.txtでDisallow を指定したい場合は”contents”に対して行います。これに
よって”afsdf001245sss”を隠蔽できます。
もちろんサーバーの設定でIndexes をオフにしておかなくてはいけません。

なお、ディレクトリー名、ファイル名に全角文字は使えませんのでご注意ください。


【ダウンロード販売設定】
DLSellerのインストール＆有効化が済むと、管理パネルの”Welcart Shop”メニューの
中に”ダウンロード販売設定”というメニューが追加されます。
WCEXダウンロード販売設定画面では、コンテンツ・ディレクトリのパスと利用規約を
記入します。

「会員情報チェックの強化」は会員情報入力の必須項目を増やすことを表します。
”強化する”にチェックを入れると住所や電話番号なども必須項目となります。
これは、継続課金や一部クレジット決済で必要となる情報を必須とするための機能です。

「コンテンツ・フォルダのパス」には初期値としてプラグインのディレクトリが既に
入っていますので、それを上で用意したディレクトリのパスに変更します。

「利用規約」は、支払方法入力ページに表示されるものです。
通常課金の商品には「利用規約」が、継続課金の商品に対しては「継続化金曜利用規約」が
表示されます。カートの中が全て物販商材だった場合は利用規約は表示されません。

「転送レート」はダウンロード用の転送レートです。初期値は1000になっていますが
ダウンロードが込み合ってエラーになる場合はレートを下げてください。


【基本設定】
”Welcart Shop”メニューの基本設定で支払方法を作成します。
決済方法は物販同様いろいろ選択できるようになっています。
銀行振り込みの場合は、管理パネルより入金済みにして初めてダウンロードが可能と
なります。またクレジット決済の場合は購入後すぐにダウンロードできるようになります。

「クレジット決済設定」についてはWelcart のオンラインマニュアルをご覧ください。


【商品登録】
「区分」を選択するとその商品に必要な項目のみに表示が切り替わります。
以下はDLSeller に必要な第2ブロックの各フィールドについての説明です。

・区分
　配送が必要な商品は「物販」、ダウンロードファイルの場合は「コンテンツファイル」、
　作業やサポートの場合は「サービス」を選択します。区分を選択することによって以下に
　表示される項目が変ってきます。

・配送関連項目 ---- 物販のみ
　通常のWelcart と同様の配送関連項目が表示されます。

・有効期間（日数） ---- コンテンツのみ
　ファイルの再ダウンロードできる期間となります。
　無期限の場合は空白若しくは0と記入します。

・契約期間（月数） ---- すべての区分
　継続課金を行う場合、その契約期間を設定します。1年契約の場合は12と入力します。
　契約更新通知自動メール（機能追加予定）に利用されるデータとなります。

・ファイル名・・・コンテンツのみ
　コンテンツファイルの場合、ファイル名を記入します。
　ファイル名に全角文字は使えません。

・公開日・・・コンテンツのみ
　コンテンツファイルの場合、公開年月日を記入します。（[例]：2010/06/12）

・最新バージョン・・・コンテンツのみ
　コンテンツファイルの場合、現在公開しているバージョン番号を記入します。

・作者・・・コンテンツのみ
　コンテンツファイルの場合、作者名を記入します。

・購入数・・・コンテンツのみ
　当月購入された数が表示されます。（）の中は総数。

・ダウンロード数・・・コンテンツのみ
　コンテンツファイルの場合、再ダウンロードも含め当月ダウンロード数が表示されます。
　（）の中は総数。

　

【継続課金会員リスト】
DLSeller を有効化すると、管理パネルのサイドメニュー「Welcart Managament」の中に
「継続課金会員リスト」というメニューが追加されます。このページには、継続課金契約を
行った会員のリストが表示されます。

継続課金の場合、クレジットカードの有効期限が切れますと、代金の回収ができなくなります。
有効期限当月になった場合、リストの「カード（月/年）」の項目の中に、更新依頼メールを
契約者に対して送信するためのリンクが表示されます。送信されたメールに従って処理を
行なうことで、契約者は簡単にカード情報を更新する事ができます。
但し、この機能は「ルミーズ」のみで「PayPalエクスプレス」では利用できません。

「WelcartPay」で利用している場合は、会員のマイページより、カード情報が変更できます。
また、継続課金を契約中の会員は、マイページより退会ができません。（退会ボタンを非表示）

「PayPalエクスプレス」の継続課金では、カード情報の更新は、契約者がPayPal の
管理画面にて更新作業を行なう必要が有ります。クレジットカードの有効期限切れのために
代金を回収できなかった場合、PayPal 側から、契約者とショップオーナーにメールで
通知されます。また、継続課金会員リストの「状態」項目に回収不履行のメッセージが
表示されますので、適宜対応してください。



【その他の設定】
DLSeller としての設定はここまでです。その他はWelcart 本体の設定となります。
詳細はオンラインマニュアルをご覧ください。



==============
ライセンス
==============
このプラグインのライセンスはGPLとなっております。



==============
著作権
==============
著作権は、同梱のスクリプトに記載してあるAuthor（作者）が保有しています。



==============
サポート
==============
この商品は、ご購入後30日間はスタンダード・サポートがご利用いただけます。
このサービスは主に環境の違いによる不具合の原因究明が主な目的であり、
修正等の実作業はお客様ご自身が行うことになります。作業をご依頼される場合は
改めてお見積りさせていただきます。
また、お客様自身がプラグインのカスタマイズ行っている場合は、簡単には
動作不良の原因が特定できませんので、別途調査費が必要になる場合がございます。

30日の有効期限が過ぎた場合は、新たにスタンダード・サポートをご購入いただくか
「開発フォーラム」でご質問ください。

なお、このサポートでの連絡手段はメールのみとなっており、電話でのサポートが
必要な場合は別途プレミアム・サポートのご購入が必要となります。
またこのサポートは、100パーセント原因を解明できるものではありませんので
予めご了承ください。

このプラグインの最新版は無償でダウンロードする事ができます。
welcart.com にて、WCEX DLSellerの詳細ページを確認して、お手持ちの
バージョン情報と比較してください。
会員情報ページの購入履歴より再ダウンロードができます。



==============
お問い合わせ
==============
このプラグインに関するお問い合わせ、およびスタンダード・サポートのご依頼は
こちらのフォームからお願いいたします。
https://www.welcart.com/wc-support/wc-paysupport/support_form/



==============
更新履歴
==============
v3.0.0  　2017/8/7
・ダウンロード無制限商品の購入完了画面での表示不具合を修正
・継続課金会員リストリニューアル
・「商品一括登録」「商品データ出力」で、「在庫数」「在庫ステータス」のみ更新できるように仕様変更
・マイページで、ダウンロード有効期間を過ぎたコンテンツはダウンロードできないように修正
・「商品一括登録」「商品データ出力」CSVで、カテゴリーをスラッグで登録・出力できるように仕様変更

v2.2.1  　2016/12/26
・会員登録・更新時に、パスワードをセッションに保持しないよう修正
・自動継続課金ではない商品の領収書に「次回引き落とし日」が表示される不具合を修正
・ダウンロード商品を購入後、管理画面から削除、別のダウンロード商品を追加すると、マイページからダウンロードできない不具合を修正
・物販の継続課金商品で、クレジット決済以外が選択できないよう修正

v2.2.0  　2016/10/05
・【WelcartPay】対応
・継続課金会員リストの「次回契約更新日」の日付がおかしくなる不具合を修正
・商品CSVの文字コードオプションを、アップロードだけでなくダウンロードにも適用するよう仕様変更
・フロントマイページの購入履歴商品名の出力にhookを追加
・WCEX Multiple Shippingと併用の際、物販商品購入時に複数配送先指定ができない不具合を修正
・「会員規約への同意」機能使用時に会員ページから会員情報を更新するとエラーになる不具合を修正

v2.1.16  　2016/7/8
・WCEX SKU Select使用時の選択値が表示されない不具合を修正

v2.1.15  　2016/6/16
・商品データCSVアップロードの際にpost_metaを削除してしまわないよう修正
・wc_templatesを使用しないと、物販の購入で配送方法のフィールドが表示されない不具合の修正
・フィルターフック'dlseller_filter_completion_list'に、引数$iが足りない不具合を修正

v2.1.14  　2016/4/11
・マイページからの領収書PDF、請求書PDFが「No permission」となる不具合を修正

v2.1.13  　2016/4/6
・会員履歴からダウンロードする請求書PDF・領収書PDFの印刷ページを別タブ化
・usces_dlseller_filename()内部で使用しているdlseller_get_filename()の第二引数に$skuが渡されていない不具合を修正

v2.1.12  　2016/3/17
・購入遷移で、新規入会ができない不具合を修正

v2.1.11  　2016/3/16
・カード有効期限の更新処理（ルミーズ）がうまくできない不具合を修正

v2.1.10  　2016/2/10
・2.1.9で、受注明細が記録されない事が有る不具合等を修正

v2.1.9  　2016/2/8
・ログファイルに書き込み権限が無いと受注番号がおかしくなる不具合を修正
・子テーマのwc_templatesの仕様変更
・合計金額が0円になるときも、ポイントを使用するフォームが表示される不具合を修正
・エラーメッセージが文字化けする不具合を修正

v2.1.8  　2015/12/11
・welcart ver 1.6.3以降使用時にPDF出力でエラーがでる不具合を修正
・新規商品追加画面で、商品区分の選択がうまく行かない不具合を修正
・会員情報編集画面で、メールアドレスに必須チェックが入っていない不具合を修正
・商品一括登録時、CSVから取得したテキストが途中で切れる不具合を修正

v2.1.7  　2015/11/06
・日付の取得が、一部標準時になってしまっていた不具合を修正

v2.1.6  　2015/10/24
・ダウンロード方式を微調整
・内容確認画面、各種メール、各種PDF の「使用ポイント」「税額」の表示位置を調整

v2.1.5  　2015/7/18
・銀行振り込みの場合、ダウンロード期限を、入金日換算にするよう仕様を変更
・サービス商材のとき、内蔵テンプレートで複数SKUが表示されない不具合を修正
・大きなサイズのファイルをダウンロードする際、ブラウザがロックされる不具合を修正
・商品区分が「サービス」の場合、内蔵テンプレートの商品詳細ページにてエラーがでる不具合を修正

v2.1.4  　2014/11/11
・管理受注より追加した商品（ダウンロードコンテンツ）が、フロントの会員履歴ページからダウンロードできない不具合を修正

v2.1.3  　2014/11/7
・CSVアップロードの際のシステム設定「CSVファイルの文字コード」の機能反映
・CSVアップロードで商品登録をすると、Post Nameがおかしな形でエンコードされる不具合を修正
・CSVのSKU項目追加カスタマイズ対応フィルター追加、ラジオボタン・チェックボックスのデータチェック箇所修正

v2.1.2  　2014/5/30
・商品オプション使用時に商品詳細ページでエラーが出ている不具合を修正
・会員ログインとお客様情報ページにて、オートコンプリートされている情報が自動挿入される不具合を修正
・Welcart 1.4 対応
・物販の継続課金商品のとき、受注時の自動送信メールの継続課金金額が、送料が加算された金額になっていない不具合を修正

v2.1.1  　2014/4/17
・WordPress 3.9 対応
・継続課金で、受注日課金ができるよう仕様を変更
・請求書PDF、領収書PDF に、継続課金情報が記載されない不具合を修正
・wc_templatesを使用していると、商品詳細ページにパスワード保護がかからない不具合を修正
・送料計算がおかしい不具合を修正

v2.1.0  　2013/3/15
・Welcart1.3 に対応

v2.0.10  　2013/1/22
・wc_templatesが適用されていないページがある不具合を修正
・新規会員登録でメールアドレスチェックが効いていない不具合を修正
・CSV一括登録で、公開日時が変更されない不具合を修正
・新パスワード取得のページで、メールアドレス入力欄にNoticeが出ている不具合を修正
・メール送信完了画面の翻訳もれを修正

v2.0.9  　2012/10/1
・商品データ出力（CSV）において、カスタムフィールドが出力されない不具合を修正
・SKUコードが全角だとダウンロードができない不具合を修正
・カート遷移中の新規会員フォームにwc_templatesが採用されていない不具合を修正
・商品CSV登録で、タグが新規登録されない不具合を修正
・サービス販売でのテンプレートを複数SKUに対応

v2.0.8  　2012/6/14
・決済完了画面にて、データダウンロードのボタンが表示されていなかった不具合を修正

v2.0.8  　2012/6/14
・決済完了画面にて、データダウンロードのボタンが表示されていなかった不具合を修正

v2.0.7  　2012/5/14
・[複写して新規]昨日で、カスタムフィールドとdlseller項目が複写され無い不具合を修正
・SSLを通っていないと、会員ページのPDFが表示されない不具合を修正
・物販がカートに有った場合のお客様情報の再チェック機能を追加

v2.0.6  　2012/2/15
・SSL利用時、会員ページでPDFが見れない不具合を修正
・一括登録でゴミ箱の中までチェックしないよう仕様を変更

v2.0.5  　2012/1/30
・1.1.0で商品csv登録するとWarningが出る不具合を修正
・新たにドキュメントを添付（DLSellerDocument.zip）

v2.0.4  　2012/1/25
・Welcart1.1 に対応

v2.0.3  　2011/11/7
・商品オプションのセレクト・マルチセレクトを使用するとエラーが出る不具合を修正

v2.0.2  　2011/7/23
・[会員情報を修正して次へ]をクリックしても次に進めない不具合を修正
・商品リストのCSV出力で、絞込検索が効いていない不具合を修正
・メールからのパスワード変更ページが表示されない不具合を修正

v2.0.1  　2011/6/25
・CSV一括登録での不具合を修正
・PayPal エクスプレスでの不具合を修正
・複合検索で遷移先がおかしくなる不具合を修正

v2.0  　2011/5/31
・物販の同時運営ができるよう仕様を変更
・PayPal エクスプレスの継続課金に対応
・DLSeller 専用のwc_templates を添付

v1.2.5  　2010/12/22
・再ダウンロードページでオートpタグが入らない不具合を修正

v1.2.4  　2010/11/19
・決済完了ページでエラーが出る不具合を修正

v1.2.3  　2010/10/28
・カスタムメンバーフィールドの必須チェックが通っていなかった不具合を修正

v1.2.2  　2010/10/15
・出力文字のメタ処理を修正

v1.2.1  　2010/9/28
・Welcart 0.7 に伴いリンクの修正を行いました

v1.2  　2010/9/21
・大きなサイズのコンテンツのダウンロードに対応

v1.1.1  　2010/9/17
・商品詳細ページでのエラーを修正

v1.1  　2010/9/9
・ルミーズの自動継続課金に対応

v1.0  　2010/7/6
・公開開始

